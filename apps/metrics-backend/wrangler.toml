# Cloudflare Workers configuration for PartyLayer Metrics Backend

name = "partylayer-metrics"
main = "src/index.ts"
compatibility_date = "2024-01-17"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "partylayer-metrics"
database_id = "your-database-id-here"  # Replace after running `wrangler d1 create partylayer-metrics`

# Scheduled triggers for aggregation
[triggers]
crons = [
  "0 0 * * *",   # Daily at midnight UTC
  "0 0 1 * *"   # Monthly on 1st day
]

# Environment variables
[vars]
ENVIRONMENT = "production"
# API_KEY = "your-api-key"  # Set via wrangler secret

# Development overrides
[env.dev]
name = "partylayer-metrics-dev"

[env.dev.vars]
ENVIRONMENT = "development"
